<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Homework</title>

  <!-- Jquery e Vue -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.1.8/vue.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

  <!-- Bootstrap CSS -->
  <link href="https://netdna.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://netdna.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  <!-- CSS Files -->
  <link rel="stylesheet" href="CSS/fonts.css">
  <link rel="stylesheet" href="CSS/form_style.css">
  <link rel="stylesheet" href="CSS/list_style.css">
  <link rel="stylesheet" href="CSS/error_style.css">
  <link rel="stylesheet" href="CSS/auth_page.css">
  <link rel="stylesheet" href="CSS/snackbar.css">

  <!--Vuelidate-->
  <script src="https://unpkg.com/vuelidate@0.7.4/dist/vuelidate.min.js"></script>
  <script src="https://unpkg.com/vuelidate@0.7.4/dist/validators.min.js"></script>

  <!--Fontawesome-->
  <script src="https://kit.fontawesome.com/e8cfddc4ed.js" crossorigin="anonymous"></script>

  <!--Ionicons-->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
</head>

<body>

  <div id="auth">
    <!--Tela de autenticação do usuário-->
    <div class="main-box" v-if="authPage">
      <div class="auth-box">
        <div class="box-title">
          <p class="main-title">Bem Vindo!</p>
          <p class="sub-title" v-text="titulo"></p>
        </div>

        <p v-text="toggleButton" v-on:click="setFormAction(!isLogin)"></p>

        <div class="box-login">
          <form id="auth-form">
            <div v-if="isLogin">
              <div class="form-group">
                <label for="nickname"> <i class="fa-solid fa-envelope"></i> Email</label>
                <input type="email" id="nickname" v-model="$v.login.email.$model" placeholder="Email do usuário"
                  autocomplete="email" class="form-control">
                <span class="errorMessage" v-if="!$v.login.email.required">Campo Obrigatório !</span>
              </div>

              <div class="form-group">
                <label for="senha"> <i class="fa-solid fa-lock"></i> Senha</label>
                <input type="password" id="senha" v-model="$v.login.senha.$model" placeholder="Senha do usuário"
                  autocomplete="current-password" class="form-control">
                <span class="errorMessage" v-if="!$v.login.senha.required">Campo Obrigatório !</span>
                <span class="errorMessage" v-if="!$v.login.senha.minLength">A senha deve ter no mínimo {{
                  $v.login.senha.$params.minLength.min }} caracteres.</span>
              </div>
            </div>

            <div v-else>
              <div class="form-group">
                <label for="username"> <i class="fa-solid fa-user"></i> Nome</label>
                <input type="text" id="username" v-model.trim="$v.cadastro.name.$model" placeholder="Nome do usuário"
                  autocomplete="username" class="form-control">
                <span class="errorMessage" v-if="!$v.cadastro.name.required">Campo Obrigatório !</span>
                <span class="errorMessage" v-if="!$v.cadastro.name.maxLength">O nome deve ter no máximo {{
                  $v.cadastro.name.$params.maxLength.max }} caracteres.</span>
              </div>

              <div class="form-group">
                <label for="email"> <i class="fa-solid fa-envelope"></i> Email</label>
                <input type="email" id="email" v-model="$v.cadastro.email.$model" placeholder="Email do usuário"
                  autocomplete="email" class="form-control">
                <span class="errorMessage" v-if="!$v.cadastro.email.required">Campo Obrigatório !</span>
              </div>

              <div class="form-group">
                <label for="senha"> <i class="fa-solid fa-lock"></i> Senha</label>
                <input type="password" id="senha" v-model="$v.cadastro.senha.$model" placeholder="Senha do usuário"
                  autocomplete="current-password" class="form-control">
                <span class="errorMessage" v-if="!$v.cadastro.senha.required">Campo Obrigatório !</span>
                <span class="errorMessage" v-if="!$v.cadastro.senha.minLength">A senha deve ter no mínimo {{
                  $v.login.senha.$params.minLength.min }} caracteres.</span>
              </div>

              <div class="form-group">
                <label for="confirmSenha"> <i class="fa-solid fa-lock"></i> Repita sua senha</label>
                <input type="password" id="confirmSenha" v-model="$v.cadastro.confirmSenha.$model"
                  placeholder="Repita sua senha novamente" autocomplete="current-password" class="form-control">
                <span class="errorMessage" v-if="!$v.cadastro.confirmSenha.sameAsPassword">A senha deve ser a mesma
                  digitada no campo acima.</span>
              </div>
            </div>

            <button type="button" @click="authBtn($v)" v-text="actionButton" class="btn btn-dark">Entrar</button>
            <button type="button" id="google-btn" @click="googleLogin" class="btn btn-light"><i class="fa-brands fa-google"></i> Entrar com o
              Google</button>
          </form>
        </div>
      </div>
    </div>

  </div>

  <div id="app">
    <!--Página inicial do app-->
    <div v-if="!authPage">
      <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <a class="nav-item nav-link active" id="nav-form-tab" data-toggle="tab" href="#nav-form" role="tab"
            aria-controls="nav-form" aria-selected="true">Formulário</a>
          <a class="nav-item nav-link" id="nav-activity-tab" data-toggle="tab" href="#nav-activity" role="tab"
            aria-controls="nav-activity" aria-selected="false">Atividades</a>
          <a class="nav-item nav-link" id="nav-logout-tab"><i @click="signOut"
              class="fa-solid fa-arrow-right-from-bracket"></i></a>
        </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-form" role="tabpanel" aria-labelledby="nav-form-tab">

          <div class="homepage-content">

            <fieldset class="fieldset-border">
              <legend class="legend-style">Cadastro de Atividades</legend>

              <form id="formulario" @submit.prevent="createActivity">
                <div class="form-group">
                  <label for="inputTitle">Título</label>
                  <input type="text" v-model.trim="$v.nova_atividade.title.$model" id="inputTitle"
                    placeholder="Título da atividade" class="form-control">
                  <span class="errorMessage" v-if="!$v.nova_atividade.title.required">Campo Obrigatório !</span>
                  <span class="errorMessage" v-if="!$v.nova_atividade.title.maxLength">O título deve conter no máximo
                    {{$v.nova_atividade.title.$params.maxLength.max}}
                    caracteres.</span>
                </div>

                <div class="form-group">
                  <label for="inputDate">Data de Entrega</label>
                  <input type="date" v-model="$v.nova_atividade.data_entrega.$model" id="inputDate"
                    class="form-control">
                  <span class="errorMessage" v-if="!$v.nova_atividade.data_entrega.minValue">Informe
                    uma data
                    válida (superior a data atual).</span>
                </div>

                <div class="form-group">
                  <label for="subject">Disciplina</label>
                  <select id="subject" v-model="$v.nova_atividade.subject.$model" class="form-control">
                    <option disabled value="">Escolha um item</option>
                    <option v-for="subject in Subjects" v-bind:value="subject">
                      {{ subject.name }}
                    </option>
                  </select>
                  <span class="errorMessage" v-if="!$v.nova_atividade.subject.required">Campo Obrigatório !</span>
                </div>

                <div class="form-group">
                  <label for="ActivityTopics">Tópicos da Atividade</label>
                  <textarea id="ActivityTopics" v-model="nova_atividade.topics" rows="3"
                    placeholder="Descreva os tópicos dessa atividade" class="form-control"></textarea>
                </div>

                <div class="form-buttons">
                  <button type="button" @click="cleanForm" class="btn btn-dark">Limpar Formulário
                  </button>
                  <button type="submit" :disabled="submitStatus === 'PENDING'" class="btn btn-dark">Salvar</button>
                </div>
              </form>

              <div v-bind="snackbarAttrs" v-text="message"></div>
            </fieldset>
          </div>
        </div>

        <div class="tab-pane fade" id="nav-activity" role="tabpanel" aria-labelledby="nav-activity-tab">
          <div class="activity-content">
            <input type="text" id="filter" @input="getValue(filter)" v-model="filter"
              placeholder="Pesquise por sua atividade cadastrada" class="form-control">

            <div v-for="(activity, id) in Activities" class="card-activity">
              <div class="card-main-content">
                <div class="card-main-text">
                  <p class="card-title">{{ activity.title }}</p>
                  <p class="card-subject">{{ activity.subject.name }}</p>
                </div>

                <div class="card-actions">
                  <i v-on:click="editActivity(id)" class="fa-solid fa-pen-to-square"></i>
                  <i v-on:click="deleteActivity(activity.key)" class="fa-solid fa-trash-can"></i>
                </div>
              </div>

              <div class="card-footer-content">
                <i class="fa-solid fa-flag"></i>
                <p class="card-date">{{ activity.date | formataData }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!--Bibliotecas do Firebase e do Cloud Firestore-->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>


  <script src="JS/firebase.js"></script>
  <script src="JS/models.js"></script>
  <script type="text/javascript" src="JS/script.js"></script>
</body>

</html>